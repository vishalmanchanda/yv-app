<nav class="navbar navbar-expand-lg fixed-top shadow-sm" [class.navbar-light]="!isDarkTheme" [class.navbar-dark]="isDarkTheme" [class.bg-dark]="isDarkTheme" [class.bg-light]="!isDarkTheme">
  <div class="container-fluid px-2">
    <!-- Mobile View Layout -->
    <div class="d-flex d-lg-none align-items-center justify-content-between w-100">
      <!-- Left Actions with Logo -->
      <div class="d-flex align-items-center gap-1">
        <button class="btn btn-link nav-link p-1" type="button" (click)="toggleSidebar.emit()">
          <i class="bi bi-list fs-4"></i>
        </button>
        <a class="navbar-brand d-flex align-items-center p-0" routerLink="/">
          <img [src]="logoUrl" 
               alt="Logo" 
               height="30"
               (error)="onLogoError($event)">
        </a>
      </div>

      <!-- Right Actions -->
      <div class="d-flex align-items-center gap-1">
        <button class="btn btn-link nav-link p-1" (click)="toggleTheme()">
          <i class="bi" [class.bi-sun]="isDarkTheme" [class.bi-moon]="!isDarkTheme"></i>
        </button>

        <!-- Updated Notifications Button -->
        <button class="btn btn-link nav-link p-1">
          <i class="bi bi-bell position-relative">
            <span class="notification-badge" *ngIf="unreadNotifications > 0">
              {{ unreadNotifications }}
            </span>
          </i>
        </button>

        <!-- Mobile Menu Toggle -->
        <div class="dropdown">
          <button class="btn btn-link nav-link p-1" 
                  type="button" 
                  (click)="toggleMobileMenu()"
                  #mobileMenuTrigger>
            <i class="bi bi-three-dots-vertical"></i>
          </button>
          <!-- Mobile Menu Dropdown -->
          <div class="dropdown-menu dropdown-menu-end mobile-menu" 
               [class.show]="isMobileMenuOpen">
            <!-- Navigation Links -->
            <div class="mobile-menu-items">
              <a *ngFor="let link of navLinks" 
                 class="dropdown-item d-flex align-items-center"
                 [routerLink]="link.route"
                 routerLinkActive="active"
                 [routerLinkActiveOptions]="{exact: link.exact}"
                 (click)="onMobileMenuItemClick()">
                <i [class]="link.icon + ' me-2'"></i>
                <span>{{ link.label }}</span>
              </a>
            </div>
            <div class="dropdown-divider"></div>
            <!-- Additional Actions -->
            <a class="dropdown-item d-flex align-items-center" (click)="toggleChatbot()">
              <i class="bi bi-chat-dots me-2"></i>
              <span>Support</span>
            </a>
            <a class="dropdown-item d-flex align-items-center" href="#">
              <i class="bi bi-bell me-2"></i>
              <span>Notifications</span>
              <span class="ms-auto badge bg-danger" *ngIf="unreadNotifications">
                {{ unreadNotifications }}
              </span>
            </a>
          </div>
        </div>

        <!-- User Menu (Mobile) -->
        <app-user-menu [user]="user" class="mobile-user-menu"></app-user-menu>
      </div>
    </div>

    <!-- Desktop View Layout -->
    <div class="d-none d-lg-flex align-items-center justify-content-between w-100">
      <!-- Left section with brand and navigation -->
      <div class="d-flex align-items-center">
        <a class="navbar-brand d-flex align-items-center" routerLink="/">
          <img [src]="logoUrl" 
               alt="Logo" 
               height="30" 
               class="me-2"
               (error)="onLogoError($event)">
          <span>{{ brandName }}</span>
        </a>
        
        <ul class="navbar-nav ms-4">
          <li class="nav-item" *ngFor="let link of navLinks">
            <a class="nav-link d-flex align-items-center" 
               [routerLink]="link.route"
               routerLinkActive="active"
               [routerLinkActiveOptions]="{exact: link.exact}">
              <i [class]="link.icon + ' me-2'"></i>
              <span>{{ link.label }}</span>
            </a>
          </li>
        </ul>
      </div>

      <!-- Right section with actions -->
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-link nav-link" (click)="toggleTheme()">
          <i class="bi" [class.bi-sun]="isDarkTheme" [class.bi-moon]="!isDarkTheme"></i>
        </button>

        <!-- Updated Notifications Button -->
        <button class="btn btn-link nav-link position-relative">
          <i class="bi bi-bell position-relative">
            <span class="notification-badge" *ngIf="unreadNotifications > 0">
              {{ unreadNotifications }}
            </span>
          </i>
        </button>

        <button class="btn btn-link nav-link" (click)="toggleChatbot()">
          <i class="bi bi-chat-dots"></i>
        </button>

        <app-user-menu [user]="user"></app-user-menu>
      </div>
    </div>
  </div>
</nav> 